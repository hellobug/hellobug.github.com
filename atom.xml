<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Hello Bug~]]></title>
  <link href="http://hellobug.github.com/atom.xml" rel="self"/>
  <link href="http://hellobug.github.com/"/>
  <updated>2013-10-10T00:39:49+08:00</updated>
  <id>http://hellobug.github.com/</id>
  <author>
    <name><![CDATA[hellobug]]></name>
    <email><![CDATA[joy.xczhang+hellobug@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(5-2)] Directive - Compile vs. Link]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-directive-2-compile-vs-link/"/>
    <updated>2013-08-14T20:35:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-directive-2-compile-vs-link</id>
    <content type="html"><![CDATA[<p>还是先从栗子们看起~</p>

<p>如果我想实现这样一个功能，当一个input失去光标焦点时(blur)，执行一些语句，比如当输入用户名后，向后台发ajax请求查询用户名是否已经存在，好有及时的页面相应。</p>

<p>输入 <strong>hellobug</strong>   <br/>
<img src="http://hellobug.github.com/my-images/angularjs-directive-2-input-focus.png"></p>

<p>失去焦点后提示 <strong>hellobug</strong> 这个用户名已经存在  <br/>
<img src="http://hellobug.github.com/my-images/angularjs-directive-2-input-blur.png"></p>

<!-- more -->


<p>代码如下：</p>

<figure class='code'><figcaption><span>HTML </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body</span> <span class="na">ng-controller=</span><span class="s">&quot;MainCtrl&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;lable&gt;</span>用户名:
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;username&quot;</span> <span class="na">ng-blur=</span><span class="s">&quot;checkUsername()&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">&quot;color:red;&quot;</span> <span class="na">ng-show=</span><span class="s">&quot;usernameAlreadyExist&quot;</span><span class="nt">&gt;</span>用户名已经存在<span class="nt">&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/lable&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>controller和directive的定义 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">checkUsername</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">//send ajax to check on server</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">username</span> <span class="o">===</span> <span class="s1">&#39;hellobug&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$scope</span><span class="p">.</span><span class="nx">usernameAlreadyExist</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;ngBlur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$document</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>         <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">ngBlur</span><span class="p">);</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>在上面的例子里，directive返回对象里定义的<code>link</code>方法在blur事件触发时执行了scope上的<code>checkUsername()</code>方法。</p>

<p>如果是只有<code>link</code>方法，也可以简单的写成下面这种形式~直接返回<code>link</code>对应的function~</p>

<figure class='code'><figcaption><span>directive的简单写法 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;ngBlur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$document</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>       <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">ngBlur</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<p>再来这样一个功能，我想让内容为<code>哈哈哈哈</code>的dom元素重复n遍，n是自定义的，以达到某种满屏大笑丧心病狂的效果 -_-，我知道<code>ng-repeat</code>就已经能干这事儿了，但是如果自己实现一下呢~</p>

<figure class='code'><figcaption><span>HTML </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;ul</span> <span class="na">repeater=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li&gt;</span>哈哈哈哈<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>directive的定义 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;repeater&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$document</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">restrict</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">compile</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">children</span><span class="p">().</span><span class="nx">clone</span><span class="p">();</span>
</span><span class='line'>      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">repeater</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">clone</span><span class="p">());</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>在上面例子的<code>compile</code>方法里，子元素被复制成了<code>repeater</code>制定的数量。</p>

<hr />

<p>什么时候用compile，什么时候用link呢，或者两者可不可以一起用呢？</p>

<p>先从directive是如何在angular手下生效的说起吧~</p>

<h2>编译三阶段：</h2>

<h3>1. 标准浏览器API转化</h3>

<p>将html转化成dom，所以自定义的html标签必须符合html的格式</p>

<h3>2. Angular compile</h3>

<p>搜索匹配directive，按照<code>priority</code>排序，并执行directive上的<code>compile</code>方法</p>

<h3>3. Angular link</h3>

<p>执行directive上的<code>link</code>方法，进行scope绑定及事件绑定</p>

<h2>为什么编译的过程要分成compile和link?</h2>

<p>简单的说就是为了解决性能问题，特别是那种model变化会影响dom结构变化的，而变化的结构还会有新的scope绑定及事件绑定，比如<code>ng-repeat</code></p>

<h2><code>compile</code>和<code>link</code>的形式</h2>

<h3>compile</h3>

<ul>
<li><code>function compile(element, attrs, transclude) { ... }</code></li>
<li>在compile阶段要执行的函数，返回的function就是link时要执行的function</li>
<li>常用参数为<code>element</code>和<code>attrs</code>，分别是dom元素和元素上的属性们，其它的以后细说</li>
<li>较少使用，因为大部分directive是处理dom元素的行为绑定，而不是改变它们</li>
</ul>


<h3>link</h3>

<ul>
<li><code>function link(scope, element, attrs, controller) { ... }</code></li>
<li>在link阶段要执行的函数，这个属性只有当compile属性没有设置时才生效</li>
<li>常用参数为<code>scope</code>，<code>element</code>和<code>attrs</code>，分别是当前元素所在的scope，dom元素和元素上的属性们，其它的以后细说</li>
<li>directive基本上都会有此函数，可以注册事件，并与scope相绑</li>
</ul>


<h2><code>compile</code>和<code>link</code>的使用时机</h2>

<h3>compile</h3>

<ul>
<li>想在dom渲染前对它进行变形，并且不需要scope参数</li>
<li>想在所有相同directive里共享某些方法，这时应该定义在compile里，性能会比较好</li>
<li>返回值就是link的function，这时就是共同使用的时候</li>
</ul>


<h3>link</h3>

<ul>
<li>对特定的元素注册事件</li>
<li>需要用到scope参数来实现dom元素的一些行为</li>
</ul>


<h2>最后~</h2>

<p>本节目所用示例可以猛戳<a href="http://plnkr.co/edit/77dGPHMz1mwRJHghTcXl">这里</a>查看ho~</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(5-1)] Directive - 开场小介绍]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-directive-1-basic-introduction/"/>
    <updated>2013-08-04T22:35:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-directive-1-basic-introduction</id>
    <content type="html"><![CDATA[<p>Directive其实就是让html变得更强大的一种方法。它可以根据需求对dom变形，或注入行为。</p>

<p>觉得它很神秘么，其实一点儿也不神秘，只要开始使用AngularJS了，就一定在使用着Directive，比如我们在html上写的那些<code>ng-controller</code>，<code>ng-model</code>，<code>ng-show</code>等等都是AngularJS提供的Directive啊~</p>

<p>那到底内部是怎么实现的呢？或者如果觉得AngularJS内置提供的Directive不给力咋办？现在咱们就自己做一个试试看吧~</p>

<!-- more -->


<p><img src="http://hellobug.github.com/my-images/angularjs-directive-1-address-inputs.png"></p>

<p>先来个比较简单的需求，假如我们的应用经常要用到地址信息的输入选项，如果不自定义directive，html要写成这样~</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;address&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      国家:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;country&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      城市:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;city&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      街道详情:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;address&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      邮编:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;zipcode&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样的代码可能要写多次，给维护也添加了复杂度。
如果自定义个地址的directive，代码如下：</p>

<figure class='code'><figcaption><span>之前的html </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">my-address</span><span class="nt">&gt;</span> <span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>抽出来的html模板，名称为address.html </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;address&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      国家:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;country&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      城市:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;city&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      街道详情:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;address&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'>  <span class="nt">&lt;label&gt;</span>
</span><span class='line'>      邮编:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;zipcode&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/label&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>directive的定义 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s2">&quot;myAddress&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">restrict</span><span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">templateUrl</span><span class="o">:</span> <span class="s2">&quot;address.html&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">replace</span><span class="o">:</span> <span class="kc">true</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h2>命名</h2>

<p>可能有人注意到了，在html里标签上定义的属性叫<code>my-address</code>，可是在js里定义directive时写的名字是<code>myAddress</code>，这能对应上么？</p>

<p>其实是可以的，不仅如此，下列格式都可以识别出来~</p>

<ul>
<li>my:address</li>
<li>my-address (推荐)</li>
<li>my_address</li>
<li>x-my-address</li>
<li>data-my-address</li>
</ul>


<p>但是由于html不区分大小写和标准写法是用中横线<code>-</code>的特性，比较推荐<code>my-address</code>这种写法，既简洁又遵循html的规则。</p>

<h2>声明形式限制</h2>

<p><code>restrict: "A"</code> 这一句表示对directive声明形式的限制，一共有四种：</p>

<ul>
<li><code>E</code>: <code>&lt;my-address&gt;&lt;/my-address&gt;</code> Element Name 标签名</li>
<li><code>A</code>: <code>&lt;div my-address="exp"&gt;&lt;/div&gt;</code> Attribute 属性名（默认值）</li>
<li><code>C</code>: <code>&lt;div class="my-address: exp;"&gt;&lt;/div&gt;</code> Class 类名</li>
<li><code>M</code>: <code>&lt;!-- directive: my-address exp --&gt;</code> Comment 注释</li>
</ul>


<p>其实不写也可以，因为如果不写，默认就是<code>restrict: "A"</code></p>

<p>如果想支持多项，可以写成<code>restrict: "EA"</code>，这样就又支持标签的写法，又支持属性的写法</p>

<p>虽然一共有四种可以选择，但后两种并不推荐~</p>

<ul>
<li>类应该更多的是与样式相关，而且将directive名混杂在一群类名里，可读性也不好</li>
<li>注释就更不可靠了，将重要的逻辑写在注释里，太容易被忽略了</li>
</ul>


<h2>Html内容模板指定</h2>

<p><code>templateUrl: "address.html"</code>指定了模板的Url路径，如果想直接写html内容也可以用：<br/>
<code>template: "&lt;div class='address'&gt;blabla&lt;/div&gt;"</code></p>

<p>下面的<code>replace: true</code>表示模板html内容是否会替换<code>&lt;div my-address&gt;&lt;/div&gt;</code>，还是插入到<code>&lt;div my-address&gt;&lt;/div&gt;</code>元素里，默认是<code>false</code></p>

<h2>最后</h2>

<p>这样一个简单的directive就写好了，其实如果只是想抽html模板的话，还可以用<code>ng-include</code>，相当上上面例子里<code>replace:false</code>的效果~</p>

<figure class='code'><figcaption><span>使用ng-include的版本 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//注意这里是单引号套着双引号，外面一层引号是表示标签属性的值，里面一层引号表示直接给的模板名称，因为这里也可以通过表达式的返回值来取
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">ng-include=</span><span class="s">&#39;&quot;address.html&quot;&#39;</span><span class="nt">&gt;</span> <span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>貌似更简单。。。那前面说那么多干嘛？！<br/>
这不是为了熟悉directive嘛~ -_-|||</p>

<p>想自己动手试试，就猛戳<a href="http://plnkr.co/edit/ZgRpLtlRPsGWL14m7J3p">这里</a>吧~</p>

<p>其实directive的世界搭滴恨(小纪念一下在西安悠哉的小日子)，下集待续。。。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(4)] 那伤不起的provider们啊~ (provider, value, constant, service, factory, decorator)]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-providers/"/>
    <updated>2013-04-23T22:35:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-providers</id>
    <content type="html"><![CDATA[<p>用AngularJS做项目，但凡用过什么service啊，factory啊，provider啊，开始的时候晕没晕？！晕没晕？！感觉干的事儿都差不多啊，到底用哪个啊？！别告诉我你们几个就是为了跟我炫耀兄弟多！！<img src="http://hellobug.github.com/my-images/emotions/xianzhuozi.jpg"></p>

<p>好吧。。。也许是我的问题，脑仁儿确实不够大，反正我是晕的直挠墙~</p>

<p>那到底什么时候该请他们谁出场啊？</p>

<p>经过挠墙之后挠官网文档挠google挠源码挠例子试验，终于让我把他们的区别给挠出来了！（得意的笑～～）</p>

<p>首先，<code>provider</code>, <code>value</code>, <code>constant</code>, <code>service</code>, <code>factory</code>他们都是provider！（<code>decorator</code>小朋友先搬个小板凳坐在边上等会儿，现在还没轮到你出场哈~）</p>

<p>provider是干啥的？</p>

<!-- more -->


<p>provider可以为应用提供通用的服务，形式可以是常量，也可以是对象。</p>

<p>比如我们在controller里常用的<code>$http</code>就是AngularJS框架提供的provider～</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">myApp</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="err">‘</span><span class="nx">MainController</span><span class="err">&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$http</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="err">…</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在上面的代码里，就可以直接使用<code>$http</code>包好的各种功能了～</p>

<h1>provider</h1>

<p>那我们自己想定制一个provider，怎么写呢～</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">//定义:</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">provider</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">start</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">$get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//或</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">provider</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$filterProvider</span><span class="p">){</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">$get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//调用:</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span> <span class="c1">//12</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>provider的基本原则就是通过实现<code>$get</code>方法来在应用中注入单例，使用的时候拿到的<code>age</code>就是<code>$get</code>执行后的结果。
上面例子中的两种定义方法都可以～</p>

<h1>factory</h1>

<p>大哥<code>provider</code>每次出场太繁琐了，如果我就想定义个<code>$get</code>，没别的乱七八糟的呢？这时候该二哥<code>factory</code>出场了～</p>

<p>（脑补背景音乐：葫芦娃～葫芦娃～一根藤上七朵花～[我说你够了啊！>_&lt;]）</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">provider</span><span class="p">(</span><span class="s1">&#39;myDate&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//可以写成</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;myDate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//调用:</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">myDate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">myDate</span> <span class="o">=</span> <span class="nx">myDate</span><span class="p">;</span> <span class="c1">//current date</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>直接第二个参数就是$get要对应的函数实现，代码简单了很多有没有？！</p>

<h1>service</h1>

<p>这时候我又来劲儿了，我不仅就想定义个<code>$get</code>，里面我还就返回个new出来的已有js类，三哥<code>service</code>闪亮登场～</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">provider</span><span class="p">(</span><span class="s1">&#39;myDate&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//可以写成</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;myDate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'><span class="c1">//可以写成</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;myDate&#39;</span><span class="p">,</span> <span class="nb">Date</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>对于这种需求，代码更简洁了是不是～～</p>

<h1>value vs. constant</h1>

<p>更直接的需求来了，我只想定义个<code>$get</code>，而且就返回个常量～</p>

<p>这时候<code>value</code>和<code>constant</code>都可以做到～</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="s1">&#39;pageCount&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">constant</span><span class="p">(</span><span class="s1">&#39;pageCount&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>兄弟俩功能一样？双胞胎？那怎么可能～</p>

<p>介绍区别前，先得把之前坐小板凳等着的<code>decorator</code>叫出来～终于该出场了～</p>

<h3>区别一：<code>value</code>可以被修改，<code>constant</code>一旦声明无法被修改</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$provide</span><span class="p">.</span><span class="nx">decorator</span><span class="p">(</span><span class="s1">&#39;pageCount&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$delegate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">$delegate</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>decorator</code>可以用来修改（修饰）已定义的provider们，除了<code>constant</code>～</p>

<h3>区别二：<code>value</code>不可在<code>config</code>里注入，<code>constant</code>可以</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">myApp</span><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">pageCount</span><span class="p">){</span>
</span><span class='line'>    <span class="c1">//可以得到constant定义的&#39;pageCount&#39;</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>关于<code>config</code>，之后会专门介绍～</p>

<h2>通过底层实现代码看关系～</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">provider</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">provider_</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">provider_</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">provider_</span> <span class="o">=</span> <span class="nx">providerInjector</span><span class="p">.</span><span class="nx">instantiate</span><span class="p">(</span><span class="nx">provider_</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">provider_</span><span class="p">.</span><span class="nx">$get</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">throw</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Provider &#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; must define $get factory method.&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">providerCache</span><span class="p">[</span><span class="nx">name</span> <span class="o">+</span> <span class="nx">providerSuffix</span><span class="p">]</span> <span class="o">=</span> <span class="nx">provider_</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">factoryFn</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">provider</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="p">{</span> <span class="nx">$get</span><span class="o">:</span> <span class="nx">factoryFn</span> <span class="p">});</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">service</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">constructor</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$injector&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$injector</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">$injector</span><span class="p">.</span><span class="nx">instantiate</span><span class="p">(</span><span class="nx">constructor</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}]);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">value</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">factory</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">valueFn</span><span class="p">(</span><span class="nx">value</span><span class="p">));</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">constant</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">providerCache</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">instanceCache</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">decorator</span><span class="p">(</span><span class="nx">serviceName</span><span class="p">,</span> <span class="nx">decorFn</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">origProvider</span> <span class="o">=</span> <span class="nx">providerInjector</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">serviceName</span> <span class="o">+</span> <span class="nx">providerSuffix</span><span class="p">),</span>
</span><span class='line'>        <span class="nx">orig$get</span> <span class="o">=</span> <span class="nx">origProvider</span><span class="p">.</span><span class="nx">$get</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">origProvider</span><span class="p">.</span><span class="nx">$get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">origInstance</span> <span class="o">=</span> <span class="nx">instanceInjector</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">orig$get</span><span class="p">,</span> <span class="nx">origProvider</span><span class="p">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">instanceInjector</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">decorFn</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="p">{</span><span class="nx">$delegate</span><span class="o">:</span> <span class="nx">origInstance</span><span class="p">});</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>从上面的代码可以看出之前介绍的每种provider的特点，<code>decorator</code>比较特殊，不算，除了<code>constant</code>，另外几个最终调用的都是<code>provider</code>～</p>

<h2>最后再总结一下provider哥儿几个的优点～</h2>

<h4>1. 为应用提供通用的服务，形式可以是常量或对象</h4>

<h4>2. 便于模块化</h4>

<h4>3. 便于单元测试</h4>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(3)] View-Model双向绑定背后的故事~]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-two-ways-binding/"/>
    <updated>2013-03-27T22:13:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-two-ways-binding</id>
    <content type="html"><![CDATA[<p>剧情开始之前，先介绍一下重要背景~三个概念~</p>

<ul>
<li><strong>Dirty Checking</strong> – AngularJS内部比较value现在的值和之前的值，如果发生了改变，就触发change事件。</li>
<li><strong>Digest</strong> – 执行<code>Dirty Checking</code>的机制，由$digest()触发。</li>
<li><strong>Apply</strong> – 当dom事件在AngularJS机制外被触发时，需要通知AngularJS进行<code>Digest</code>。由<code>$apply()</code>触发。</li>
</ul>


<!-- more -->


<h1>$digest()</h1>

<p><img src="http://hellobug.github.com/my-images/angularjs-2-ways-1-1.png"></p>

<p>Digest就像AngularJS的心跳一样~ <br/>
它每50ms蹦一次，蹦的时候会触发所属的scope和其所有子scope的dirty checking，dirty checking又会触发$watch()（马上会介绍<code>$watch()</code>），整个Angular双向绑定机制就活了起来~（有人可能会问了，蹦的这么频繁，性能体验神马的都没问题么？一会儿咱专门聊这个哈~）
注意：不建议直接调用<code>$scope.$digest()</code>，而应该使用<code>$scope.$apply()</code>，原因一会儿细说~</p>

<h1>$watch()</h1>

<p><img src="http://hellobug.github.com/my-images/angularjs-2-ways-1-2.png"></p>

<p>每个成功的digest背后都有一群好watch~</p>

<ul>
<li>在digest执行时，如果<code>watch</code>观察的value与上次执行时不一样时，就会被触发</li>
<li>AngularJS内部的watch实现了页面随model的及时更新</li>
<li>也可手动调用~ <br/>
  <strong>参数1</strong>：待观察的value <br/>
  <strong>参数2</strong>：value改变时想执行的操作 <br/>
  <strong>参数3</strong>：true表示比较的是值，而不是引用，由于javascript对象比较比较的是引用地址（可参考<a href="http://hellobug.github.com/blog/javascript-variable-assignment/" title="[JS] 让人犯晕的Javascript变量赋值">这篇blog</a>），所以即使重新赋值了相同的内容，也会触发change事件，而大部分时候，对于相同的内容，我们不希望执行watch里的操作，所以可以把第三个参数设置成true。</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="cm">/* Do something here */</span>
</span><span class='line'><span class="p">},</span> <span class="kc">true</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h1>$apply()</h1>

<p><img src="http://hellobug.github.com/my-images/angularjs-2-ways-1-3.png"></p>

<p>我们可以把<code>apply</code>看成个给AngularJS送信的~ <br/>
<code>$scope.$apply()</code>会触发digest，如果有一个function参数，function会先被执行，再digest~</p>

<p><strong>应该啥时候用呢？</strong> <br/>
当dom事件在AngularJS机制外被触发时~</p>

<p><strong>什么样的情况算机制外呢？</strong><br/>
喂，jQuery，你就别看别人了~！！</p>

<p>现在到这个问题了，<strong>为啥推荐使用<code>$apply</code>而不是<code>$digest</code>？</strong>  <br/>
因为<code>$apply</code>其实不能把信直接送给<code>$digest</code>，之间还有<code>$eval</code>门卫把关，如果<code>$apply</code>带的表达式不合法，<code>$eval</code>会把错误送交<code>$exceptionHandler service</code>，合法才触发digest，所以更安全~</p>

<p><strong>举个栗子~</strong></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-blur=</span><span class="s">&quot;closeDialog()&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">myApp</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;ngBlur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>     <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">restrict</span><span class="o">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>               <span class="nx">$</span><span class="p">(</span><span class="nx">elelment</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>                    <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">ngBlur</span><span class="p">);</span>
</span><span class='line'>               <span class="p">});</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>     <span class="p">};</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>jQuery对blur事件的绑定就属于AngularJS机制外触发，必须使用<code>$apply</code>才能生效。</p>

<h1>Performance</h1>

<p>下面开始说性能了，50ms跳一次，受不受得了呢？</p>

<p><strong>先来看两条科学研究的结果：</strong></p>

<ul>
<li><strong>人对变化的反应是慢的</strong>：任何比50ms还快的变化都是不可被察觉的~</li>
<li><strong>人对信息的处理能力是有限的</strong>：在一页处理2000条信息已经算是极限了，再多的信息量往一页上堆只能说是不好的设计了，而且人也无法处理了~</li>
</ul>


<p>所以问题就演变为：<strong>我们能不能在50ms里做2000次比较呢？</strong> <br/>
其实，以现在的技术来说，即使是很慢的浏览器也没问题的。当然如果每个比较都写的特别复杂就另说了~也就是说在写watch语句时，如果要watch的语句太复杂的话，看看是不是可以重构简化一下啦~</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(2)] Scope什么的~]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-scope/"/>
    <updated>2013-03-15T20:47:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-scope</id>
    <content type="html"><![CDATA[<p>Scope是AngularJS里的一个很重要的概念，简单的说它就是用来保存AngularJS Model们的对象，是Model们温暖的小家～</p>

<p>那这个小家是什么时候造的呢？</p>

<!-- more -->




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">&quot;mainApp&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们知道，<code>ng-app</code>是一个应用启动AngularJS的入口点，在这里也会创建一个root scope，在controller里可以通过<code>$rootScope</code>调到，每个应用只能有一个root scope（当然了～root嘛～），但它会有多个child scope，那啥时候会创建child scope呢？</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">&quot;mainApp&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;body</span> <span class="na">ng-controller=</span><span class="s">&quot;MainCtrl&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&quot;SubCtrl&quot;</span> <span class="na">ng-include</span> <span class="na">src=</span><span class="s">&quot; &#39;template.html&#39; &quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>            <span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in items&quot;</span><span class="nt">&gt;</span>{{item.name}}<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在上面的例子里，<code>ng-controller</code> <code>ng-include</code> <code>ng-repeat</code>都创建了新的child scope（<code>ng-repeat</code>是对每一个重复的元素都创建了新的child scope），他们之间的父子关系是这样的：</p>

<p><img src="http://hellobug.github.com/my-images/angularjs-scope-1-1.png"></p>

<p>包含关系即是他们的父子关系，子scope是可以访问父scope上绑定的所有model和function的。</p>

<p>AngularJS会给scope对应的dom添加叫ng-scope的class，如果我们给自己的应用加这样一个css~</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.ng-scope</span> <span class="p">{</span><span class="k">border</span><span class="o">:</span> <span class="m">2px</span> <span class="k">dotted</span> <span class="nb">red</span><span class="p">;}</span>
</span></code></pre></td></tr></table></div></figure>


<p>通过红色的虚线边框我们也可以看出来大概scope的范围，但注意，并不是所有的ng-scope都是新的scope，有些ng-scope类名对应的dom共享的是同一个scope。</p>

<p>细心的童鞋可能注意到，<code>ng-controller="SubCtrl"</code>和<code>ng-include</code>放在同一个div上了，为啥<code>ng-controller="SubCtrl"</code>就是爸爸，<code>ng-include</code>就是儿子呢？ <br/>
这个没啥特别的原因，<code>ng-controller</code>在AngularJS底层代码里实现的比较靠前而已，与在div上标明的顺序无关，但是这时会发生一个问题：</p>

<p>假如在<code>ng-include</code>对应的<code>template.html</code>里有这样的代码：</p>

<figure class='code'><figcaption><span>template.html </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;lastName&quot;</span> <span class="nt">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们会发现，在<code>ng-controller="SubCtrl"</code>这个controller里是取不到<code>lastName</code>的值的。</p>

<p>原因是这样的~ <br/>
我们假设<code>ng-controller="SubCtrl"</code>对应的是<strong>Scope A</strong>，<code>ng-include</code>对应的是<strong>Scope B</strong>~</p>

<ol>
<li><code>ng-include</code>创建的<strong>Scope B</strong>是<code>ng-controller</code>创建的<strong>Scope A</strong>的子scope，所以在<code>template.html</code>里可以访问<strong>Scope A</strong>的model和function。</li>
<li>在<code>template.html</code>里用<code>ng-model</code>绑定的model，是存放在<strong>Scope B</strong>上的，<strong>Scope A</strong>是拿不到的，即使model同名。</li>
</ol>


<p>解决方案：</p>

<ul>
<li>直接对<strong>Scope A</strong>的model绑定成员对象，如<code>ng-model="user.lastName"</code></li>
<li>或在<code>template.html</code>使用<code>ng-model</code>绑定model时，加上<code>$parent</code>（取父scope），如：<code>ng-model="$parent.lastName"</code>，这样info就绑定在<strong>Scope A</strong>上了</li>
</ul>


<p>比较推荐第一种方式，因为第一种抽象出了对象，比起第二种所有的model都直接绑在$scope上来，封装的更好~</p>

<p><a href="http://docs.angularjs.org/guide/scope">这里是官方Scope介绍~</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[AngularJS系列(1)] 感受篇~]]></title>
    <link href="http://hellobug.github.com/blog/angularjs-introduction/"/>
    <updated>2013-03-12T20:10:00+08:00</updated>
    <id>http://hellobug.github.com/blog/angularjs-introduction</id>
    <content type="html"><![CDATA[<p>先来俩栗子感受一下~</p>

<!-- more -->


<p><code>栗1</code>现在有个需求，希望页面上某段文字及时的显示某个输入框的输入内容~</p>

<p>如果我们用jQuery来写是这样的：</p>

<figure class='code'><figcaption><span>栗1 - jQuery版本 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;h1&gt;</span>Hello, <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;namePlaceholder&quot;</span><span class="nt">&gt;&lt;/span&gt;&lt;/h1&gt;</span>
</span><span class='line'><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">&quot;name&quot;</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#name&#39;</span><span class="p">).</span><span class="nx">keydown</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#namePlaceholder&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>如果用AngularJS来写呢，是这样的：</p>

<figure class='code'><figcaption><span>栗1 - AngularJS版本 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;h1&gt;</span>Hello, {{name}}<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>栗2</code>又来个需求，有个人名的数组，想把这些名字列到页面上~</p>

<figure class='code'><figcaption><span>栗2 - jQuery版本 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;list&quot;</span><span class="nt">&gt;&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="p">[</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;王五&#39;</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#list&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;li&gt;&#39;</span> <span class="o">+</span> <span class="nx">item</span> <span class="o">+</span> <span class="s1">&#39;&lt;/li&gt;&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>栗2 - AngularJS版本 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;ul&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in [&#39;张三&#39;, &#39;李四&#39;, &#39;王五&#39;]&quot;</span><span class="nt">&gt;</span>{{item}}<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>通过比较，可以发现<a href="http://angularjs.org/">AngularJS</a>：</p>

<ul>
<li><strong> 代码更简洁 </strong>（少写好多js代码啊~）</li>
<li><strong> 扩展了html的功能 </strong>（html貌似变的很强大哇！）</li>
<li><strong> 实现了model和view的双向绑定 </strong>（随时在input里输入，随时通过<code>ng-model</code>绑定到<code>name</code>这个model上~）</li>
</ul>


<p>其实<a href="http://angularjs.org/">AngularJS</a>还：</p>

<ul>
<li><strong> 分离了JS逻辑和页面渲染 </strong>（本来JS又要忙数据交互，又要忙业务逻辑，又要忙页面渲染，现在html长大了，可以分担了~）</li>
<li><strong> 为JS提供了MVC框架 </strong>（我们熟悉的MVC~）</li>
<li><strong> 提供了One Page Application流畅的用户体验 </strong>（不像以前，每换一个页面都要重新向后台申请，现在是华丽的页面间无缝切换啊~）</li>
<li><strong> 提供依赖注入机制 </strong>（意味着更支持模块化~）</li>
<li><strong> 便于写单元测试 </strong>（行为和界面分离后，行为很方便测试啊~质量更有保障~）</li>
</ul>


<p>以后会慢慢介绍这些优点，先来看一个完整的AngularJS应用：</p>

<figure class='code'><figcaption><span>main.html </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!doctype html&gt;</span>
</span><span class='line'><span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">&quot;myApp&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;head&gt;</span>
</span><span class='line'>          <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>          <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;app.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/head&gt;</span>
</span><span class='line'>      <span class="nt">&lt;body&gt;</span>
</span><span class='line'>          <span class="nt">&lt;h1&gt;</span>Hello, {{name}}<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>          <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>              <span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in nameList&quot;</span><span class="nt">&gt;</span>{{item}}<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>app.js </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">,</span> <span class="p">[]);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;MainCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">nameList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;王五&#39;</span><span class="p">];</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong> <code>ng-app</code> </strong>:  <br/>
AngularJS的入口点。从这里开始，AngularJS系统就开始工作了~后面对应的<code>myApp</code>是在<code>app.js</code>文件里定义的angular module，module上注册了一个controller <code>MainCtrl</code>，model都是绑定在它对应的<code>$scope</code>上的。Scope的概念以后会细讲。</p>

<p><strong> <code>ng-model</code> </strong>: <br/>
在所有表单输入元素(input, select, textarea)上都可以用<code>ng-model</code>将value和model绑定起来，所输入的数值会直接被赋到对应的model上。</p>

<p><strong> <code>ng-repeat</code> </strong>: <br/>
遍历数组<code>nameList</code>重复当前页面元素。</p>

<p><strong> 其它扩展过的标签属性们 </strong>：<br/>
<a href="http://docs.angularjs.org/api">官方API</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[JS] 让人犯晕的Javascript变量赋值]]></title>
    <link href="http://hellobug.github.com/blog/javascript-variable-assignment/"/>
    <updated>2013-01-27T23:17:00+08:00</updated>
    <id>http://hellobug.github.com/blog/javascript-variable-assignment</id>
    <content type="html"><![CDATA[<h1>变量赋值</h1>

<p>开始之前先来几个例子，确保起始点是晕的状态～ :P</p>

<figure class='code'><figcaption><span>例1.1 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;apple&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;banana&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">b</span>
</span></code></pre></td></tr></table></div></figure>


<p>按理说，b = a后，a是啥值b就应该跟着是啥值了~<br/>
但，<code>b</code>结果是<code>"apple"</code>，还是一开始赋值时a的值。</p>

<!-- more -->




<figure class='code'><figcaption><span>例1.2 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;banana&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">b</span><span class="p">.</span><span class="nx">name</span>
</span></code></pre></td></tr></table></div></figure>


<p>这回，b又不争气的跟着a变了，<code>b.name</code>结果是<code>"banana"</code></p>

<figure class='code'><figcaption><span>例1.3 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;banana&quot;</span><span class="p">};</span>
</span><span class='line'><span class="nx">b</span><span class="p">.</span><span class="nx">name</span>
</span></code></pre></td></tr></table></div></figure>


<p>这回b又坚持自己了，<code>b.name</code>结果是<code>"apple"</code></p>

<figure class='code'><figcaption><span>例1.4 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">count</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">count</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'><span class="nx">b</span>
</span></code></pre></td></tr></table></div></figure>


<p>同样<code>b</code>的结果还是最开始的<code>2</code>，b到底是要闹哪样？！<img src="http://hellobug.github.com/my-images/emotions/xianzhuozi.jpg"></p>

<p>======================开始解释的分割线==============================</p>

<p>其实b很无辜，这个要从ECMAScript的变量值类型说起~</p>

<p>类型共有两种：</p>

<ul>
<li><strong>基本类型 (primitive values)</strong> - 包括Undefined, Null, Boolean, Number和String五种基本数据类型</li>
<li><strong>引用类型 (reference values)</strong> - 保存在内存中的对象们，不能直接操作，只能通过保存在变量中的地址引用对其进行操作</li>
</ul>


<p>现在回来看第一个例子<code>例1.1</code></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;apple&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>"apple"</code>是String类型，属于基本类型，这时值是这样储存的：</p>

<p><img src="http://hellobug.github.com/my-images/javascript-variable-assignment-1-1.png"></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这时a的值被copy了一份赋给了b：</p>

<p><img src="http://hellobug.github.com/my-images/javascript-variable-assignment-1-2.png"></p>

<p>所以，从此a和b井水不犯河水，各自怎么修改都不会影响对方了~</p>

<p>再来看第二个例子<code>例1.2</code></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>{name: "apple"}</code>是一个Object，属于引用类型，赋值前后值是这样存储的：</p>

<p><img src="http://hellobug.github.com/my-images/javascript-variable-assignment-1-3.png"></p>

<p>所以当<code>a.name = "banana";</code>时，修改的是大家共同指向的内存中的object的属性值，所以<code>b.name</code>的值也就跟着变了。</p>

<p><code>例1.3</code>中，</p>

<figure class='code'><figcaption><span>例1.3 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;banana&quot;</span><span class="p">};</span>
</span><span class='line'><span class="c1">// {name: &quot;banana&quot;} 是内存中的一个新的Object了，</span>
</span><span class='line'><span class="c1">// a变量存储的地址也是指向这个新的Object的了，所以和b又无关了</span>
</span><span class='line'><span class="nx">b</span><span class="p">.</span><span class="nx">name</span> <span class="c1">//还是&quot;apple&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>例1.4</code>中，</p>

<figure class='code'><figcaption><span>例1.4 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">{</span><span class="nx">count</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">count</span><span class="p">;</span>
</span><span class='line'><span class="c1">// a.count是Number类型，所以值被copy给b，</span>
</span><span class='line'><span class="c1">// 从此再怎么修改与b无关了</span>
</span><span class='line'><span class="nx">a</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'><span class="nx">b</span> <span class="c1">//还是2</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>小总结，变量赋值时总是会copy一份的，如果是基本类型，copy的就是实际的值，如果是引用类型，copy的是指向Object的地址值，所以指向的还是同一个Object。</strong></p>

<hr />

<h1>变量比较</h1>

<p>顺手再来看看变量的比较~</p>

<figure class='code'><figcaption><span>例2.1 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">&quot;apple&quot;</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="s2">&quot;apple&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nx">a</span> <span class="o">==</span> <span class="nx">b</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个没问题，结果肯定是<code>true</code>。</p>

<p>那这个呢？</p>

<figure class='code'><figcaption><span>例2.2 </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">];</span>
</span><span class='line'><span class="nx">a</span> <span class="o">==</span> <span class="nx">b</span>
</span></code></pre></td></tr></table></div></figure>


<p>虽然俩数组长一模一样，结果还是<code>false</code>。</p>

<p>其实原理还是一样，<strong>对于基本类型，比较的就是实际的值，而对于引用类型（Array也是一种Object），比较的是地址值</strong>，虽然两个数组内容是一样的，但它们在内存中是两个Object，地址是不一样，所以比较的结果是<code>false</code>。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Powershell里的单引号君和双引号君]]></title>
    <link href="http://hellobug.github.com/blog/powershell-quotes-rule/"/>
    <updated>2012-10-26T22:38:00+08:00</updated>
    <id>http://hellobug.github.com/blog/powershell-quotes-rule</id>
    <content type="html"><![CDATA[<p>Powershell里怎么使用单引号君<code>'</code>和双引号君<code>"</code>及单引号君的弟弟反单引号君<code>`</code>呢？</p>

<!-- more -->


<h3>规则1. 单引号（所见即所得）</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Write-Host <span class="s1">&#39;haha&#39;</span>
</span><span class='line'><span class="c"># haha</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$a</span> <span class="o">=</span> 2
</span><span class='line'>Write-Host <span class="s1">&#39;1 + 1 = $a&#39;</span>
</span><span class='line'><span class="c"># 1 + 1 = $a</span>
</span></code></pre></td></tr></table></div></figure>


<h3>规则2. 双引号（代换内部变量）</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Write-Host <span class="s2">&quot;haha&quot;</span>
</span><span class='line'><span class="c"># haha</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$a</span> <span class="o">=</span> 2
</span><span class='line'>Write-Host <span class="s2">&quot;1 + 1 = $a&quot;</span>
</span><span class='line'><span class="c"># 1 + 1 = 2</span>
</span></code></pre></td></tr></table></div></figure>


<h3>规则3. 反单引号（取消变量代换，转义字符，换行连接符）</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#取消变量代换</span>
</span><span class='line'><span class="nv">$a</span> <span class="o">=</span> 2
</span><span class='line'>Write-Host <span class="s2">&quot;1 + 1 = `$a&quot;</span>
</span><span class='line'><span class="c"># 1 + 1 = $a</span>
</span><span class='line'>
</span><span class='line'><span class="c">#转义字符</span>
</span><span class='line'>Write-Host <span class="s2">&quot;I said: `&quot;</span>Hello Bug~<span class="sb">`</span><span class="s2">&quot;&quot;</span>
</span><span class='line'><span class="c"># I said: &quot;Hello Bug~&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c">#换行连接符</span>
</span><span class='line'><span class="nv">$a</span> <span class="o">=</span> 1 + <span class="sb">`</span>
</span><span class='line'>2
</span><span class='line'>Write-Host <span class="nv">$a</span>
</span><span class='line'><span class="c"># 3</span>
</span></code></pre></td></tr></table></div></figure>


<h3>规则4. 想输出，写两遍</h3>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#双引号里的单引号，单引号里的双引号，都直接写就可以输出了</span>
</span><span class='line'>Write-Host <span class="s2">&quot;ha&#39;ha&quot;</span>
</span><span class='line'><span class="c"># ha&#39;ha</span>
</span><span class='line'>Write-Host <span class="s1">&#39;ha&quot;ha&#39;</span>
</span><span class='line'><span class="c"># ha&quot;ha</span>
</span><span class='line'>
</span><span class='line'><span class="c">#双引号里的双引号，单引号里的单引号，写两遍就可以输出了</span>
</span><span class='line'>Write-Host <span class="s2">&quot;ha&quot;&quot;ha&quot;</span>
</span><span class='line'><span class="c"># ha&quot;ha</span>
</span><span class='line'>Write-Host <span class="s1">&#39;ha&#39;&#39;ha&#39;</span>
</span><span class='line'><span class="c"># ha&#39;ha</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Github Pages + Octopress 搭建篇] - Geek般的写博客呦~]]></title>
    <link href="http://hellobug.github.com/blog/github-pages-and-octopress-blog-setup/"/>
    <updated>2012-08-24T01:31:00+08:00</updated>
    <id>http://hellobug.github.com/blog/github-pages-and-octopress-blog-setup</id>
    <content type="html"><![CDATA[<p>一个偶然发现了<a href="http://octopress.org/">Octopress</a>，研究了一下发现真的很有意思~ 其实原理呢就是<a href="http://pages.github.com/">Github pages</a>提供了存储静态页面的空间域名和<a href="https://github.com/mojombo/jekyll">Jekyll</a>（Blog生成工具），支持Markdown格式，而Octopress呢又把Jekyll包装了一下，使用起来更方便，更可以专注在内容上啦~ 好了，开始吧~</p>

<!-- more -->


<h2>1. 准备Github Pages</h2>

<p>首先，得有个github账户（假设你用户名是xiaoming），在里面创建一个Repository，名字一定要是<code>xiaoming.github.com</code>，你才能用<code>xiaoming.github.com</code>的域名去访问你的blog~</p>

<p>然后，在你Repository的<code>Admin</code>里，左边选<code>Option</code>，右边会看到<code>Github Pages</code>的项，点击<code>Automatic Page Generator</code>按钮到下一页后，直接点击最下面的<code>Continue to Layouts</code>，到达选择模板页，不用选择，一会儿会被Octopress的模板替换掉，直接点击<code>PUBLIS</code>按钮就发布成功了，等一段时间就能生效啦~</p>

<h2>2. 准备本地环境</h2>

<p>官方的搭建说明文档在<a href="http://octopress.org/docs/setup/">这里</a>。</p>

<p>由于工作和游戏的种种原因，我使用的“2B青年必备”的Mac下的Win7。。。-_-</p>

<h4>a) Git</h4>

<p>安装<a href="http://git-scm.com/downloads">Git</a></p>

<h4>b) Ruby</h4>

<p>安装<a href="http://rubyforge.org/frs/?group_id=167">RubyInstaller</a> （>=1.9.2）</p>

<h4>c) Gem</h4>

<p>安装<a href="http://rubyinstaller.org/downloads/">DevKit</a><br/>
然后在命令行执行：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd </span>path-to-devkit
</span><span class='line'>ruby dk.rb init
</span><span class='line'>ruby dk.rb instal
</span></code></pre></td></tr></table></div></figure>


<p><em>or</em></p>

<h4>前三步可替换为RailsInstaller</h4>

<p>安装<a href="http://railsinstaller.org/">RailsInstaller</a> (包括了Ruby，Git，Gem)</p>

<h4>d) python</h4>

<p>安装<a href="http://www.python.org/getit/">Python</a>，因为代码高亮系统是基于Python编写的。</p>

<h2>3. 更改本地配置</h2>

<h4>a) 中文utf-8编码的支持</h4>

<p>在环境变量里设置<code>LANG=zh_CN.UTF-8</code>，<code>LC_ALL=zh_CN.UTF-8</code></p>

<h4>b) 把gem的更新源改为taobao，因为官方的更新源总是被河蟹-_-</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>gem sources --remove http://rubygems.org/
</span><span class='line'>gem sources -a http://ruby.taobao.org/
</span><span class='line'>gem sources -l <span class="c">#这里的输出要确保只有taobao一个源</span>
</span></code></pre></td></tr></table></div></figure>


<h4>c) 安装rdoc和bundler</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>gem install rdoc bundler
</span></code></pre></td></tr></table></div></figure>


<h2>4. 安装Octopress</h2>

<p>找个合适的目录，执行下面的命令</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># clone octopress代码</span>
</span><span class='line'>git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'><span class="nb">cd </span>octopress
</span><span class='line'>
</span><span class='line'><span class="c"># 修改octopress的gem源</span>
</span><span class='line'>vi Gemfile <span class="c"># 或notepad Gemfile</span>
</span><span class='line'>将行: <span class="nb">source</span> <span class="s2">&quot;http://rubygems.org/&quot;</span>
</span><span class='line'>改为: <span class="nb">source</span> <span class="s2">&quot;http://ruby.taobao.org/&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># 安装octopress所需的gem组件</span>
</span><span class='line'>bundle install
</span><span class='line'>
</span><span class='line'><span class="c"># 安装默认主题</span>
</span><span class='line'>rake install
</span></code></pre></td></tr></table></div></figure>


<h2>5. 关联Github Pages</h2>

<h4>a) 与Github建立连接</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake setup_github_pages
</span><span class='line'><span class="c"># 按照提示输入Github Pages Repository的url地址，如：git@github.com:xiaoming/xiaoming.github.com.git</span>
</span><span class='line'><span class="c"># 这时创建了一个githug分支用来保存source文件</span>
</span></code></pre></td></tr></table></div></figure>


<h4>b) 更新blog配置文件</h4>

<p>更新配置文件<code>octopress/_config.yml</code>，可参考<a href="http://octopress.org/docs/configuring/">官网说明</a>。
这里就可以给blog起标题副标题神马的了~</p>

<h4>c) 生成静态页面</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake generate
</span></code></pre></td></tr></table></div></figure>


<h4>d) 本地预览</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake preview
</span><span class='line'><span class="c"># 可以访问http://localhost:4000查看博客本地效果</span>
</span></code></pre></td></tr></table></div></figure>


<h4>e) 发送到github上</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake deploy
</span><span class='line'><span class="c"># 可以访问http://xiaoming.github.com查看实际效果</span>
</span></code></pre></td></tr></table></div></figure>


<h4>f) 保存source文件到github source分支上</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s2">&quot;xiaoming blog source&quot;</span>
</span><span class='line'><span class="c"># 这里如果要pull，一定要从分支pull</span>
</span><span class='line'><span class="c"># git pull origin source</span>
</span><span class='line'>git push origin <span class="nb">source</span>
</span></code></pre></td></tr></table></div></figure>


<h2>6. 开始写博客啦。。。终于。。。</h2>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># 创建新页面</span>
</span><span class='line'>rake new_page<span class="o">[</span><span class="s2">&quot;page name&quot;</span><span class="o">]</span>
</span><span class='line'><span class="c"># 创建新博文</span>
</span><span class='line'>rake new_post<span class="o">[</span><span class="s2">&quot;blog title&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>官方说明在<a href="http://octopress.org/docs/blogging/">这里</a></p>

<h4>然后。。。就没有然后了。。。才怪。。。改天继续总结。。。</h4>

<h4>^_^</h4>
]]></content>
  </entry>
  
</feed>
